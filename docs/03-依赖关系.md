# 依赖关系

## 外部依赖库

### 核心依赖

#### 1. Fossify Commons
```kotlin
implementation(libs.fossify.commons)
```
- **版本**: 5.7.2
- **用途**: Fossify项目的通用库，提供基础功能
  - 基础Activity和Fragment类
  - 通用扩展函数
  - 工具类和辅助方法
  - 主题和颜色管理

#### 2. EventBus
```kotlin
implementation(libs.eventbus)
```
- **版本**: 3.3.1
- **用途**: 组件间事件通信
- **使用场景**:
  - RecorderService向UI发送录制状态更新
  - 录制完成通知
  - 振幅数据更新（用于可视化）

#### 3. AudioRecordView
```kotlin
implementation(libs.audiorecordview)
```
- **版本**: 1.0.5
- **用途**: 音频录制可视化组件
- **使用位置**: RecorderFragment中显示实时音频波形

#### 4. TAndroidLame
```kotlin
implementation(libs.tandroidlame)
```
- **版本**: 1.1
- **用途**: MP3编码库
- **使用位置**: Mp3Recorder类中实现MP3格式录制

#### 5. AutofitTextView
```kotlin
implementation(libs.autofittextview)
```
- **版本**: 0.2.1
- **用途**: 自动调整文本大小的TextView
- **使用位置**: 底部导航标签文字自适应

### AndroidX依赖

#### 1. DocumentFile
```kotlin
implementation(libs.androidx.documentfile)
```
- **版本**: 1.1.0
- **用途**: 访问文档文件（用于Android 10+的存储访问）

#### 2. SwipeRefreshLayout
```kotlin
implementation(libs.androidx.swiperefreshlayout)
```
- **版本**: 1.1.0
- **用途**: 下拉刷新功能

#### 3. ConstraintLayout
```kotlin
implementation(libs.androidx.constraintlayout)
```
- **版本**: 2.2.1
- **用途**: 布局容器

## 构建工具依赖

### Gradle插件

1. **Android Gradle Plugin**
   - 版本: 8.11.1
   - 用途: Android应用构建

2. **Kotlin Android Plugin**
   - 版本: 2.2.21
   - 用途: Kotlin编译支持

3. **KSP (Kotlin Symbol Processing)**
   - 版本: 2.3.0
   - 用途: Kotlin代码生成（如果使用）

4. **Detekt**
   - 版本: 1.23.8
   - 用途: Kotlin代码静态分析

## 依赖版本管理

项目使用**Version Catalog**（`gradle/libs.versions.toml`）统一管理依赖版本，这是Gradle 7.0+引入的新特性。

### 优势

1. **集中管理**: 所有版本号在一个文件中
2. **类型安全**: IDE提供自动补全
3. **易于维护**: 更新版本只需修改一处

### 使用方式

在`build.gradle.kts`中：
```kotlin
dependencies {
    implementation(libs.fossify.commons)  // 使用别名引用
    implementation(libs.eventbus)
}
```

## 依赖关系图

```
Voice Recorder App
│
├── Fossify Commons (5.7.2)
│   └── AndroidX Libraries
│
├── EventBus (3.3.1)
│   └── 无依赖
│
├── AudioRecordView (1.0.5)
│   └── AndroidX Libraries
│
├── TAndroidLame (1.1)
│   └── LAME Library (native)
│
├── AutofitTextView (0.2.1)
│   └── Android Support Library
│
└── AndroidX Libraries
    ├── DocumentFile (1.1.0)
    ├── SwipeRefreshLayout (1.1.0)
    └── ConstraintLayout (2.2.1)
```

## 仓库配置

项目使用以下Maven仓库：

1. **Google Maven**: Android相关库
2. **Maven Central**: 通用Java/Kotlin库
3. **JitPack**: GitHub项目构建的库（如AudioRecordView、TAndroidLame）
4. **Maven Local**: 本地仓库

配置位置：`settings.gradle.kts`

## 依赖冲突处理

如果遇到依赖冲突，可以通过以下方式解决：

1. **查看依赖树**:
   ```bash
   ./gradlew app:dependencies
   ```

2. **排除特定依赖**:
   ```kotlin
   implementation(libs.some.library) {
       exclude(group = "conflicting.group", module = "conflicting.module")
   }
   ```

3. **强制使用特定版本**:
   ```kotlin
   configurations.all {
       resolutionStrategy {
           force("com.example:library:1.0.0")
       }
   }
   ```

## 更新依赖

1. 修改`gradle/libs.versions.toml`中的版本号
2. 同步Gradle项目
3. 运行测试确保兼容性
4. 检查是否有破坏性变更

